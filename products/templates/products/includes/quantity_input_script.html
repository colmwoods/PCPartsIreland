<script>
    /*
     * Handle enabling/disabling of +/- buttons
     */
    function handleEnableDisable(itemId) {
        const input = $(`.qty_input[data-item_id='${itemId}']`);
        const currentValue = parseInt(input.val());

        const decrementBtn = $(`.decrement-qty[data-item_id='${itemId}']`);
        const incrementBtn = $(`.increment-qty[data-item_id='${itemId}']`);

        decrementBtn.prop('disabled', currentValue <= 1);
        incrementBtn.prop('disabled', currentValue >= 99);
    }

    /*
     * Initialise buttons on page load
     */
    $('.qty_input').each(function () {
        const itemId = $(this).data('item_id');
        handleEnableDisable(itemId);
    });

    /*
     * Increment quantity
     */
    $('.increment-qty').click(function (e) {
        e.preventDefault();

        const itemId = $(this).data('item_id');
        const input = $(`.qty_input[data-item_id='${itemId}']`);
        let value = parseInt(input.val());

        if (value < 99) {
            input.val(value + 1);
            handleEnableDisable(itemId);
        }
    });

    /*
     * Decrement quantity
     */
    $('.decrement-qty').click(function (e) {
        e.preventDefault();

        const itemId = $(this).data('item_id');
        const input = $(`.qty_input[data-item_id='${itemId}']`);
        let value = parseInt(input.val());

        if (value > 1) {
            input.val(value - 1);
            handleEnableDisable(itemId);
        }
    });

    /*
     * Manual input change
     */
    $('.qty_input').change(function () {
        const itemId = $(this).data('item_id');
        handleEnableDisable(itemId);
    });
</script>